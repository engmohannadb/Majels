<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Majles -API System Documentation</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Inter font for a modern look */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f7f9;
        }
        /* Ensure code wraps */
        pre {
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .code-block {
            background-color: #1e293b; /* Slate-800 */
            color: #f8fafc; /* White */
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            font-size: 0.9rem;
        }
        .endpoint-card {
            background-color: #ffffff;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
            padding: 1.5rem;
            margin-bottom: 2rem;
            border-left: 4px solid; 
        }
        .method-tag {
            padding: 0.25rem 0.6rem;
            border-radius: 0.375rem;
            font-weight: 700;
            font-size: 0.8rem;
            text-transform: uppercase;
            width: 70px; /* Fixed width for alignment */
            text-align: center;
        }
        .GET { background-color: #d1fae5; color: #065f46; } /* Green */
        .POST { background-color: #dbeafe; color: #1e40af; } /* Blue */
        .PUT, .PATCH { background-color: #fef3c7; color: #b45309; } /* Yellow */
        .DELETE { background-color: #fee2e2; color: #991b1b; } /* Red */
    </style>
</head>
<body class="text-gray-800">

    <!-- Sidebar Navigation -->
    <div class="fixed top-0 left-0 h-full w-64 bg-white shadow-xl p-6 hidden lg:block">
        <h3 class="text-xl font-bold mb-4 border-b pb-2 text-indigo-700">Endpoints</h3>
        <nav>
            <ul class="space-y-2">
                <li><a href="#auth" class="text-gray-600 hover:text-indigo-600 font-medium block p-2 rounded-md transition duration-150">Authentication (Login)</a></li>
                <li>
                    <h4 class="font-bold mt-4 mb-2 text-sm text-gray-500">Data Tables (Full CRUD)</h4>
                    <ul class="space-y-1 pl-2 border-l-2 border-indigo-200">
                        <li><a href="#events" class="text-gray-700 hover:text-indigo-600 block transition duration-150">Events</a></li>
                        <li><a href="#units" class="text-gray-700 hover:text-indigo-600 block transition duration-150">Units</a></li>
                        <li><a href="#requests" class="text-gray-700 hover:text-indigo-600 block transition duration-150">Requests</a></li>
                    </ul>
                </li>
            </ul>
        </nav>
    </div>

    <!-- Main Content Area -->
    <main class="lg:ml-64 p-4 sm:p-8 lg:p-12">
        <header class="mb-10 pb-4 border-b border-gray-300">
            <h1 class="text-4xl font-extrabold text-indigo-800">Majles - API Documentation</h1>
            <p class="mt-2 text-lg text-gray-600">Version: 1.0 | Base URL: <code>http://localhost/API/api.php</code></p>
        </header>

        <!-- Overview -->
        <section class="mb-12 p-6 bg-indigo-50 rounded-xl border-l-4 border-indigo-500">
            <h2 class="text-2xl font-bold text-indigo-700 mb-4">Overview</h2>
            <p class="text-gray-700">This documentation covers the available endpoints for interacting with the system's data (Events, Units, Requests). All responses are in **JSON** format. Request data for POST/PUT/PATCH must be sent as **raw JSON** in the request body.</p>
            <p class="mt-2 text-sm font-semibold text-gray-600">
                All modification operations (POST, PUT, DELETE) require valid user authorization, often checking if the user is logged in or if they own the resource (`created_by`).
            </p>
        </section>
        
        <!-- ========================================================================= -->
        <!-- AUTHENTICATION -->
        <!-- ========================================================================= -->
        <h2 id="auth" class="text-3xl font-bold text-gray-800 mb-6 border-b-2 pb-2">1. Authentication</h2>

        <div class="endpoint-card border-indigo-500">
            <div class="flex items-center mb-4 space-x-4">
                <span class="method-tag POST">POST</span>
                <h3 class="text-xl font-semibold text-gray-700">User Login</h3>
            </div>
            <code class="block text-sm bg-gray-100 p-2 rounded-md mb-4">/api.php?endpoint=login</code>
            
            <h4 class="font-bold text-gray-700 mb-2">Request Body (JSON)</h4>
            <pre class="code-block">{
    "Email": "user@example.com",
    "Password": "password123"
}</pre>

            <h4 class="font-bold text-gray-700 mt-4 mb-2">Success Response (200 OK)</h4>
            <pre class="code-block">{
    "status": "success",
    "message": "Login successful",
    "user": {
        "ID": 101,
        "Email": "user@example.com",
        "Name": "John Doe"
    }
}</pre>
        </div>
        
        <!-- ========================================================================= -->
        <!-- EVENTS CRUD -->
        <!-- ========================================================================= -->
        <h2 id="events" class="text-3xl font-bold text-gray-800 mb-6 mt-10 border-b-2 pb-2">2. Events (Full CRUD)</h2>
        <p class="mb-6 text-gray-600">The `events` endpoint allows full CRUD operations. All modification operations (POST, PUT, DELETE) require the user ID to match the `created_by` field for authorization.</p>

        <!-- Read (GET) -->
        <div class="endpoint-card border-green-500">
            <div class="flex items-center mb-4 space-x-4">
                <span class="method-tag GET">GET</span>
                <h3 class="text-xl font-semibold text-gray-700">Retrieve Events</h3>
            </div>
            <div class="mb-4">
                <code class="block text-sm bg-gray-100 p-2 rounded-md">/api.php?endpoint=events [&id={event_id}]</code>
            </div>
            <h4 class="font-bold text-gray-700 mt-4 mb-2">Success Response (200 OK)</h4>
            <pre class="code-block">{
    "status": "success",
    "data": [
        { "id": 1, "unit_id": 1, "title": "Meeting", "event_date": "2024-12-01 10:00:00", "created_by": 101, ... },
        // ...
    ]
}</pre>
        </div>

        <!-- Create (POST) -->
        <div class="endpoint-card border-blue-500">
            <div class="flex items-center mb-4 space-x-4">
                <span class="method-tag POST">POST</span>
                <h3 class="text-xl font-semibold text-gray-700">Create New Event</h3>
            </div>
            <code class="block text-sm bg-gray-100 p-2 rounded-md mb-4">/api.php?endpoint=events</code>
            
            <h4 class="font-bold text-gray-700 mb-2">Request Body (Required Fields)</h4>
            <pre class="code-block">{
    "unit_id": 5,
    "title": "Community Pool Cleaning",
    "description": "Annual deep clean of the main pool.",
    "event_date": "2025-01-15 08:30:00"
    // created_by is automatically set by the API based on current user
}</pre>

            <h4 class="font-bold text-gray-700 mt-4 mb-2">Success Response (201 Created)</h4>
            <pre class="code-block">{
    "status": "success",
    "message": "Event created successfully.",
    "id": 15
}</pre>
        </div>

        <!-- Update (PUT/PATCH) -->
        <div class="endpoint-card border-yellow-500">
            <div class="flex items-center mb-4 space-x-4">
                <span class="method-tag PUT">PUT/PATCH</span>
                <h3 class="text-xl font-semibold text-gray-700">Update Existing Event</h3>
            </div>
            <code class="block text-sm bg-gray-100 p-2 rounded-md mb-4">/api.php?endpoint=events&id={event_id}</code>
            <p class="text-sm font-normal text-gray-600 mb-2">Authorization Note: Requires ownership check (user ID must match `created_by`).</p>
        </div>
        
        <!-- Delete (DELETE) -->
        <div class="endpoint-card border-red-500">
            <div class="flex items-center mb-4 space-x-4">
                <span class="method-tag DELETE">DELETE</span>
                <h3 class="text-xl font-semibold text-gray-700">Delete Event</h3>
            </div>
            <code class="block text-sm bg-gray-100 p-2 rounded-md mb-4">/api.php?endpoint=events&id={event_id}</code>
            <p class="text-sm font-normal text-gray-600 mb-2">Authorization Note: Requires ownership check.</p>
        </div>


        <!-- ========================================================================= -->
        <!-- UNITS CRUD -->
        <!-- ========================================================================= -->
        <h2 id="units" class="text-3xl font-bold text-gray-800 mb-6 mt-10 border-b-2 pb-2">3. Units (Full CRUD)</h2>
        <p class="mb-6 text-gray-600">The `units` endpoint supports full CRUD operations. Modification operations require a logged-in user for authorization.</p>
        
        <!-- Read (GET) -->
        <div class="endpoint-card border-green-500">
            <div class="flex items-center mb-4 space-x-4">
                <span class="method-tag GET">GET</span>
                <h3 class="text-xl font-semibold text-gray-700">Retrieve Units</h3>
            </div>
            <code class="block text-sm bg-gray-100 p-2 rounded-md mb-4">/api.php?endpoint=units [&id={unit_id}]</code>
            <h4 class="font-bold text-gray-700 mt-4 mb-2">Success Response (200 OK)</h4>
            <pre class="code-block">{
    "status": "success",
    "data": [
        { "id": 1, "name": "Complex Alpha", "address": "123 Main St", ... },
        // ...
    ]
}</pre>
        </div>

        <!-- Create (POST) -->
        <div class="endpoint-card border-blue-500">
            <div class="flex items-center mb-4 space-x-4">
                <span class="method-tag POST">POST</span>
                <h3 class="text-xl font-semibold text-gray-700">Create New Unit</h3>
            </div>
            <code class="block text-sm bg-gray-100 p-2 rounded-md mb-4">/api.php?endpoint=units</code>
            
            <h4 class="font-bold text-gray-700 mb-2">Request Body (Required: name, address)</h4>
            <pre class="code-block">{
    "name": "Emerald Tower",
    "address": "456 Oak Avenue, City X",
    "unit_count": 50,
    "facilities": "Pool, Gym"
}</pre>
        </div>

        <!-- Update (PUT/PATCH) -->
        <div class="endpoint-card border-yellow-500">
            <div class="flex items-center mb-4 space-x-4">
                <span class="method-tag PUT">PUT/PATCH</span>
                <h3 class="text-xl font-semibold text-gray-700">Update Existing Unit</h3>
            </div>
            <code class="block text-sm bg-gray-100 p-2 rounded-md mb-4">/api.php?endpoint=units&id={unit_id}</code>
            <p class="text-sm font-normal text-gray-600 mb-2">Authorization Note: Requires a valid logged-in user.</p>
        </div>
        
        <!-- Delete (DELETE) -->
        <div class="endpoint-card border-red-500">
            <div class="flex items-center mb-4 space-x-4">
                <span class="method-tag DELETE">DELETE</span>
                <h3 class="text-xl font-semibold text-gray-700">Delete Unit</h3>
            </div>
            <code class="block text-sm bg-gray-100 p-2 rounded-md mb-4">/api.php?endpoint=units&id={unit_id}</code>
        </div>


        <!-- ========================================================================= -->
        <!-- REQUESTS CRUD -->
        <!-- ========================================================================= -->
        <h2 id="requests" class="text-3xl font-bold text-gray-800 mb-6 mt-10 border-b-2 pb-2">4. Requests (Full CRUD)</h2>
        <p class="mb-6 text-gray-600">The `requests` endpoint supports full CRUD operations for maintenance or service requests. Creation and modifications require user login and are subject to ownership checks.</p>
        
        <!-- Read (GET) -->
        <div class="endpoint-card border-green-500">
            <div class="flex items-center mb-4 space-x-4">
                <span class="method-tag GET">GET</span>
                <h3 class="text-xl font-semibold text-gray-700">Retrieve Requests</h3>
            </div>
            <code class="block text-sm bg-gray-100 p-2 rounded-md mb-4">/api.php?endpoint=requests [&id={request_id}]</code>
            <h4 class="font-bold text-gray-700 mt-4 mb-2">Success Response (200 OK)</h4>
            <pre class="code-block">{
    "status": "success",
    "data": [
        { "id": 1, "unit_id": 10, "request_title": "Broken AC", "status": "open", "user_id": 101, ... },
        // ...
    ]
}</pre>
        </div>

        <!-- Create (POST) -->
        <div class="endpoint-card border-blue-500">
            <div class="flex items-center mb-4 space-x-4">
                <span class="method-tag POST">POST</span>
                <h3 class="text-xl font-semibold text-gray-700">Create New Request</h3>
            </div>
            <code class="block text-sm bg-gray-100 p-2 rounded-md mb-4">/api.php?endpoint=requests</code>
            
            <h4 class="font-bold text-gray-700 mb-2">Request Body (Required: unit_id, title, text)</h4>
            <pre class="code-block">{
    "unit_id": 10,
    "request_title": "Plumbing Leak in Unit 4B",
    "request_text": "There is a continuous drip from the ceiling in the bathroom.",
    // user_id and status (open) are set by the API
}</pre>
        </div>

        <!-- Update (PUT/PATCH) -->
        <div class="endpoint-card border-yellow-500">
            <div class="flex items-center mb-4 space-x-4">
                <span class="method-tag PUT">PUT/PATCH</span>
                <h3 class="text-xl font-semibold text-gray-700">Update Existing Request</h3>
            </div>
            <code class="block text-sm bg-gray-100 p-2 rounded-md mb-4">/api.php?endpoint=requests&id={request_id}</code>
            <p class="text-sm font-normal text-gray-600 mb-2">Authorization Note: Requires ownership check (user ID must match `user_id`).</p>
            <h4 class="font-bold text-gray-700 mb-2">Example Update Body</h4>
            <pre class="code-block">{
    "status": "in_progress"
}</pre>
        </div>
        
        <!-- Delete (DELETE) -->
        <div class="endpoint-card border-red-500">
            <div class="flex items-center mb-4 space-x-4">
                <span class="method-tag DELETE">DELETE</span>
                <h3 class="text-xl font-semibold text-gray-700">Delete Request</h3>
            </div>
            <code class="block text-sm bg-gray-100 p-2 rounded-md mb-4">/api.php?endpoint=requests&id={request_id}</code>
            <p class="text-sm font-normal text-gray-600 mb-2">Authorization Note: Requires ownership check.</p>
        </div>

    </main>
</body>
</html>